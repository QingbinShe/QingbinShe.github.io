<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Install Awstats and Jawstats In MAC OS</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h2>Install Awstats and Jawstats In MAC OS</h2>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h3>
            <a class="anchor" aria-hidden="true">
              <span class="octicon octicon-link"></span>
            </a>
            About awstats and jawstats
          </h3>
          <p>
            AWStats is a free powerful and featureful tool that generates advanced web, streaming, ftp or mail server statistics, graphically. Its official website is <a href="http://www.awstats.org">www.awstats.org.</a></br>
            JAWStats is a free web statistics and analytics package. It reads log files created by the ever-popular AWStats web statistics software and outputs the information in it's own format. Its official website is <a href="http://www.jawstats.com">http://www.jawstats.com</a>
          </p>

          <h3>
            <a class="anchor" aria-hidden="true">
              <span class="octicon octicon-link"></span>
            </a>
            Environment
          </h3>
          <p>
              OS: Mac OS X Yosemite 10.10.2 </br>
              Web server: Apache/2.4.9 (Unix) </br>
              Website name: 127.0.0.1 </br>
              Path of apache log file: /var/log/apache2/ </br>
              Path of apache configure file: /etc/apache2/httpd.conf </br>
              Path of awstats: /Library/WebServer/Documents/ </br>
              Path of jawstats: /Library/WebServer/Documents/ </br>
              Path of awstats data: /var/lib/
          </p>

          <h3>
            <a class="anchor" aria-hidden="true">
              <span class="octicon octicon-link"></span>
            </a>
            Install awstats
          </h3>
          <p>
            Before install awstats, the perl should be ready in your server.
          </P>
          <p>
            1. Download the awstats on official website: <a href="http://www.awstats.org/#DOWNLOAD">http://www.awstats.org/#DOWNLOAD</a>. The version of awstats we had downloaded is "Last stable version 7.3 - 2014-07-23 07:50". 
          </p>
          <p>
            2. Explode the package to "/Library/WebServer/Documents/awstats". Change the authority of these package and perl (if you don't do this, when you run awstats perl or use browser to see the result, you may be reminded of "can't access to"):
            <pre><code>$cd /Library/WebServer/Documents
$chmod -R 755 awstats
$chmod +x awstats/tools/*.pl
$chmod +x awstats/wwwroot/cgi-bin/*.pl</code></pre>
          </p>
          <p>
            3. Create the data directory "awstats" to store awstats data:
            <pre><code>$cd /var/lib
$mkdir awstats</code></pre>
          </p>
          <p>
            4. Run the configure script:
            <pre><code>$cd /Library/WebServer/Documents/awstats/tools
$perl awstats_configure.pl</code></pre>
          </p>
          <p>
            5. The process when the script is running:
            <pre><code><font color="black">sheqingbindeMacBook-Air:tools sheqingbin$ sudo perl awstats_configure.pl </font>

----- AWStats awstats_configure 1.0 (build 20140126) (c) Laurent Destailleur -----
This tool will help you to configure AWStats to analyze statistics for
one web server. You can try to use it to let it do all that is possible
in AWStats setup, however following the step by step manual setup
documentation (docs/index.html) is often a better idea. Above all if:
- You are not an administrator user,
- You want to analyze downloaded log files without web server,
- You want to analyze mail or ftp log files instead of web log files,
- You need to analyze load balanced servers log files,
- You want to 'understand' all possible ways to use AWStats...
Read the AWStats documentation (docs/index.html).

-----> Running OS detected: Mac OS
Warning: AWStats standard directory on Mac OS X is '/Library/WebServer/awstats'.
If you want to use standard directory, you should first move all content
of AWStats distribution from current directory:
/Library/WebServer/Documents/awstats
to standard directory:
/Library/WebServer/awstats
And then, run configure.pl from this location.
<font color="black">Do you want to continue setup from this NON standard directory [yN] ? y</font>

-----> Check for web server install

Enter full config file path of your Web server.
Example: /etc/httpd/httpd.conf
Example: /usr/local/apache2/conf/httpd.conf
Example: c:\Program files\apache group\apache\conf\httpd.conf
Config file path ('none' to skip web server setup):
<font color="black">> /etc/apache2/httpd.conf</font>

-----> Check and complete web server config file '/etc/apache2/httpd.conf'
  All AWStats directives are already present.

-----> Update model config file '/Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.model.conf'
  File awstats.model.conf updated.

-----> Need to create a new config file ?
Do you want me to build a new AWStats config/profile
<font color="black">file (required if first install) [y/N] ? y</font>

-----> Define config file name to create
What is the name of your web site or profile analysis ?
Example: www.mysite.com
Example: demo
Your web site, virtual server or profile name:
<font color="black">> 127.0.0.1</font>

-----> Create config file '/Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.127.0.0.1.conf'
 Config file /Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.127.0.0.1.conf created.

-----> Add update process inside a scheduler
Sorry, configure.pl does not support automatic add to cron yet.
You can do it manually by adding the following command to your cron:
/Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.pl -update -config=127.0.0.1
Or if you have several config files and prefer having only one command:
/Library/WebServer/Documents/awstats/tools/awstats_updateall.pl now
<font color="black">Press ENTER to continue... </font>


A SIMPLE config file has been created: /Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.127.0.0.1.conf
You should have a look inside to check and change manually main parameters.
You can then manually update your statistics for '127.0.0.1' with command:
> perl awstats.pl -update -config=127.0.0.1
You can also read your statistics for '127.0.0.1' with URL:
> http://localhost/awstats/awstats.pl?config=127.0.0.1

<font color="black">Press ENTER to finish...</font></code></pre>
          </p>
          <p>
            Something you should notice when you run the configure script: 1. We should run the awstats_configure.pl as root. 2. The configure script advances us to change the current directory from "/Library/WebServer/Documents/awstats" to standard directory "/Library/WebServer/awstats". But we don't do that and just continue. 3. When we create a new config file, the file will be in directory "/Library/WebServer/Documents/awstats/wwwroot/cgi-bin". In this example, the config file name is awstats.127.0.0.1.conf(awstats.your_input_sitename.conf). 4. When the formate of your apache log file is common, the script will ask you to change the formate of your log file to combined and you should answer "y".
          </p>
          <p>
            6. After running the configure file, we should change manually main parameters of configure file "/Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.127.0.0.1.conf" and "/etc/apache2/httpd.conf".
            <pre><code>$vim /Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.127.0.0.1.conf
  change LogFile="/var/log/httpd/mylog.log" to LogFile="/var/log/apache2/access_log"
$vim /etc/apache2/httpd.conf, edit the directory of awstats' parameters at the buttom of configure file:
  #
  # Directives to allow use of AWStats as a CGI
  #
  Alias /awstatsclasses <font color="black">/Library/WebServer/Documents/awstats/wwwroot/classes/"</font>
  Alias /awstatscss <font color="black">"/Library/WebServer/Documents/awstats/wwwroot/css/"</font>
  Alias /awstatsicons <font color="black">"/Library/WebServer/Documents/awstats/wwwroot/icon/"</font>
  ScriptAlias /awstats/ <font color="black">"/Library/WebServer/Documents/awstats/wwwroot/cgi-bin/"</font>
 
  #
  # This is to permit URL access to scripts/files in AWStats directory.
  #
  &ltDirectory <font color="black">"/Library/WebServer/Documents/awstats/wwwroot"></font>
      Options None
      AllowOverride None
      Order allow,deny
      Allow from all
  &lt/Directory></code></pre>
          </p>
          <p>
            7. Run awstats
            <pre><code>$cd /Library/WebServer/Documents/awstats/wwwroot/cgi-bin/
$perl awstats.pl -update -config=127.0.0.1
Create/Update database for config "./awstats.127.0.0.1.conf" by AWStats version 7.3 (build 20140126)
From data in log file "/Users/sheqingbin/Desktop/log/access_log"...
Phase 1 : First bypass old records, searching new record...
Searching new records from beginning of log file...
Phase 2 : Now process new records (Flush history on disk after 20000 hosts)...
Jumped lines in file: 0
Parsed lines in file: 17451
 Found 0 dropped records,
 Found 0 comments,
 Found 0 blank records,
 Found 0 corrupted records,
 Found 0 old records,
 Found 17451 new qualified records.</code></pre>
          </p>
          <p>
            8. The result abouve shows that awstats perl run successfully. And do as the guide, I can't read my statistics for '127.0.0.1' with URL: http://localhost/awstats/awstats.pl?config=127.0.0.1. The browser shows the source code of awstats.pl. It may be the apache server do not support the perl. But this error is not urgent because I want to use the jawstats to show the result.
          </p>

          <h3>
            <a class="anchor" aria-hidden="true">
              <span class="octicon octicon-link"></span>
            </a>
            Install jawstats
          </h3>
          <p>
            1. Download the jawstats on official website: <a href="http://www.jawstats.com/download">http://www.jawstats.com/download.</a> The version of jawstats we have downloaded is "jawstats-0.7beta".
          <p>
            2. Explode the package to "/Library/WebServer/Documents/jawstats". Change the authority of these package (if you don't do this, when you run awstats perl or use browser to see the result, you may be reminded of "can't access to"):
            <pre><code>$cd /Library/WebServer/Documents
$chmod -R 755 jawstats</code></pre>
          </p>
          <p>
            3. Edit the configure file as bellow:
            <pre><code>$cd /Library/WebServer/Documents/jawstats/
$cp config.dist.php config.php
$vim config.php
&lt?php
  // core config parameters
  $sDefaultLanguage      = "en-gb";
  $sConfigDefaultView    = "thismonth.all";
  $bConfigChangeSites    = true;
  $bConfigUpdateSites    = true;
  $sUpdateSiteFilename   = "xml_update.php"; 

  // individual site configuration
  $aConfig["127.0.0.1"] = array(
    "statspath"   => "/var/lib/awstats/",
    "updatepath"  => "/Library/WebServer/Documents/awstats/wwwroot/cgi-bin/awstats.pl",
    "siteurl"     => "http://127.0.0.1",
    "sitename"    => "",
    "theme"       => "default",
    "fadespeed"   => 250,
    "password"    => "test",
    "includes"    => "",
    "language"    => "en-gb"
  );
  
  $aConfig["site2"] = array(
    "statspath"   => "/path/to/data/",
    "updatepath"  => "/path/to/awstats.pl/",
    "siteurl"     => "http://www.my-2nd-domain.com",
    "sitename"    => "",
    "theme"       => "default",
    "fadespeed"   => 250,
    "password"    => "my-2nd-password",
    "includes"    => "",
    "language"    => "en-gb"
  ); 
?></code></pre>
          </p>
            4. See the result through URL: http://127.0.0.1/jawstats/index.php
          </p>
          <p>
            <img src="./images/install_jawstats_index.tiff">
          </p>

          <h3>
            <a class="anchor" aria-hidden="true">
              <span class="octicon octicon-link"></span>
            </a>
            More about awstats
          </h3>

          <h3>
            <a class="anchor" aria-hidden="true">
              <span class="octicon octicon-link"></span>
            </a>
            More about jawstats
          </h3>

        </section>
        <aside id="sidebar">
          <ul>
            <li><a href="./index.html">Index</a><ul></ul></li>

            <li>
              Install software
              <ul>
                <li>
                  <a href="./install_jawstats.html">awstats + jawstats</a>
                </li>
              </ul>
            </li>

            <li>
              Others
              <ul>
                <li>
                  .....
                </li>
              </ul>
            </li>
          </ul>
        </aside>
      </div>
    </div>
  </body>
</html>